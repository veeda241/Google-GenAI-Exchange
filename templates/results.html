{% extends "base.html" %}
{% block content %}
<div class="results-container">
    {% if from_history %}
    <div class="back-link-container">
        <a href="{{ url_for('profile') }}" class="back-link">&larr; Back to Profile</a>
    </div>
    {% endif %}
    <h1 class="results-header">Analysis Complete</h1>

    <div class="summary-card">
        <h2>Your Identified Skills</h2>
        <div class="skills-container">
            {% for skill in analysis.user_skills %}
                <span class="skill-tag-user">{{ skill }}</span>
            {% else %}
                <p>No specific skills were identified from your input.</p>
            {% endfor %}
        </div>
    </div>

    <h2 class="recommendations-header">Top Career Recommendations</h2>
    <div class="recommendations-grid">
        {% for rec in analysis.recommendations %}
        <div class="career-card">
            <div class="card-header">
                <h3>{{ rec.career.title }}</h3>
                <span class="match-score">{{ (rec['score'] * 100) | int }}% Match</span>
            </div>
            <p class="card-description">{{ rec.career.description }}</p>

            <h4>Skill Gap</h4>
            <div class="skills-container">
                {% for skill in rec.skill_gap %}
                    <span class="skill-tag-gap">{{ skill }}</span>
                {% else %}
                    <p>No skill gap! You have all required skills.</p>
                {% endfor %}
            </div>

            {% if rec.course_recommendations %}
            <div class="learning-section">
                <h4>Recommended Learning</h4>
                <ul>
                {% for course in rec.course_recommendations %}
                    <li><a href="{{ course.url }}" target="_blank">{{ course.title }}</a></li>
                {% endfor %}
                </ul>
            </div>
            {% endif %}

            {% if rec.career.project_ideas_detailed %}
            <div class="projects-section">
                <h4>Project Ideas to Build Your Portfolio</h4>
                <div class="video-grid">
                {% for video in rec.career.project_ideas_detailed %}
                    <a href="https://www.youtube.com/watch?v={{ video.id }}" target="_blank" class="video-card">
                        <img src="{{ video.thumbnail }}" alt="{{ video.title }}">
                        <p class="video-title">{{ video.title }}</p>
                    </a>
                {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}